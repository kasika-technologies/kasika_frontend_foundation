var KFF=(()=>{var x=Object.defineProperty;var T=(r,t)=>{for(var e in t)x(r,e,{get:t[e],enumerable:!0})};var j={};T(j,{Component:()=>h,State:()=>y});var u=(r,t)=>{!r||r.forEach(e=>{if(e.attached.includes(t)){console.error(`${t.element} has attached node that it is also attached to`);return}e.render()})};var c=r=>{let t=()=>r.map(a=>c(a)),e=()=>{let a=r.bind(void 0);return d(a),a},i=()=>{let a=new Map;for(let[s,g]of r)a.set(s,c(g));return a},l=()=>{let a={};return d(a),a},b=()=>{let a=new Set;for(let s of set)a.add(c(s));return a},d=a=>{for(let s in r)r.hasOwnProperty(s)&&(a[s]=c(r[s]))},O=()=>r.replace(/javascript:/gi,"").replace(/[^\w-_. ]/gi,function(a){return`&#${a.charCodeAt(0)};`});switch(n(r)){case"array":return t();case"function":return e();case"map":return i();case"object":return l();case"set":return b();case"string":return O();default:return r}},o=r=>({get(t,e){return["object","array"].indexOf(n(t[e]))>-1?new Proxy(t[e],o(r)):t[e]},set(t,e,i){return t[e]===i||(t[e]=i,r.render()),!0}}),f=r=>{r.debounce&&window.cancelAnimationFrame(r.debounce),r.debounce=window.requestAnimationFrame(()=>{r.render()})},n=r=>Object.prototype.toString.call(r).slice(8,-1).toLowerCase();var m=class{attached=[];debounce=null;element;template;_data;state;constructor(t,e){this.attachTo=e.attachTo?n(e.attachTo)==="array"?e.attachTo:[e.attachTo]:[],this.element=t,this.template=e.template,this.state=e.state,this.isSharedState=!!e.isSharedState,this._data=null,e.data&&!e.state&&(this._data=new Proxy(e.data,o(this))),this.state&&this.state.attach(this),this.attachTo.length&&this.attachTo.forEach(i=>{i.attach(this)})}get data(){return this._data}set data(t){return this.state||(this._data=new Proxy(t,o(this)),f(this)),!0}attach(t){let e=n(t)==="array"?t:[t];for(let i of e)this.attached.push(i)}detach(t){let e=n(t)==="array"?t:[t];for(let i of e){let l=this.attached.indexOf(i);if(l<0)return;this.attached.splice(l,1)}}render(){if(this.isSharedState){u(this.attached,this);return}if(!this.template){console.error("No template.");return}let t=n(this.element)==="string"?document.querySelector(this.element):this.element;if(!t){console.log("No element.");return}let e=c(this.state?this.state.data:this.data),i;if(n(this.template)==="function"?i=this.template(e,t,t):i=this.template,!!["string","number"].includes(n(i)))return t.innerHTML=i,u(this.attached,this),t}},h=m;var p=class extends h{constructor(t){t.isSharedState=!0,super(null,t)}},y=p;return j;})();
