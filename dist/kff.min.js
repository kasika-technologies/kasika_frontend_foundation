var KFF=(()=>{var p=Object.defineProperty;var A=(e,t,r)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var v=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})};var u=(e,t,r)=>(A(e,typeof t!="symbol"?t+"":t,r),r);var H={};v(H,{Component:()=>f,Event:()=>O,State:()=>T});var m=(e,t)=>{!e||e.forEach(r=>{if(r.attached.includes(t)){console.error(`${t.element} has attached node that it is also attached to`);return}r.render()})};var d=(e,t)=>{let r=()=>e.map(a=>d(a,t)),n=()=>{let a=e.bind(void 0);return g(a),a},s=()=>{let a=new Map;for(let[l,k]of e)a.set(l,d(k,t));return a},j=()=>{let a={};return g(a),a},y=()=>{let a=new Set;for(let l of set)a.add(d(l,t));return a},g=a=>{for(let l in e)e.hasOwnProperty(l)&&(a[l]=d(e[l],t))},E=()=>e.replace(/javascript:/gi,"").replace(/[^\w-_. ]/gi,function(a){return`&#${a.charCodeAt(0)};`});switch(c(e)){case"array":return r();case"function":return n();case"map":return s();case"object":return j();case"set":return y();case"string":return t?e:E();default:return e}},h=e=>({get(t,r){return["object","array"].indexOf(c(t[r]))>-1?new Proxy(t[r],h(e)):t[r]},set(t,r,n){return t[r]===n||(t[r]=n,e.render()),!0}}),w=e=>{e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame(()=>{e.render()})},c=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();var b=class{constructor(t,r){u(this,"attached",[]);u(this,"debounce",null);u(this,"element");u(this,"template");u(this,"_data");u(this,"state");this.attachTo=r.attachTo?c(r.attachTo)==="array"?r.attachTo:[r.attachTo]:[],this.element=t,this.template=r.template,this.state=r.state,this.isSharedState=!!r.isSharedState,this.allowHTML=r.allowHTML!==null||r.allowHTML!==void 0?r.allowHTML:!1,this._data=null,r.data&&!r.state&&(this._data=new Proxy(r.data,h(this))),this.state&&this.state.attach(this),this.attachTo.length&&this.attachTo.forEach(n=>{n.attach(this)})}get data(){return this._data}set data(t){return this.state||(this._data=new Proxy(t,h(this)),w(this)),!0}attach(t){let r=c(t)==="array"?t:[t];for(let n of r)this.attached.push(n)}detach(t){let r=c(t)==="array"?t:[t];for(let n of r){let s=this.attached.indexOf(n);if(s<0)return;this.attached.splice(s,1)}}render(){if(this.isSharedState){m(this.attached,this);return}if(!this.template){console.error("No template.");return}let t=c(this.element)==="string"?document.querySelector(this.element):this.element;if(!t){console.log("No element.");return}let r=d((this.state?this.state.data:this.data)||{},this.allowHTML),n;if(c(this.template)==="function"?n=this.template(r,t,t):n=this.template,!!["string","number"].includes(c(n)))return t.innerHTML=n,m(this.attached,this),t}},f=b;var o={},i={},P=(e,t)=>["*","window","document","document.documentElement",window,document,document.documentElement].indexOf(t)>-1?!0:typeof t!="string"&&t.contains?t===e||t.contains(taarget):e.closest(t),_=(e,t,r)=>{for(let n=0;n<e.length;n++)return e[n].selector===t&&e[n].callback.toString()===r.toString()?n:-1},x=e=>{!i[e.type]||i[e.type].forEach(t=>{!P(e.target,t.selector)||t.callback(e)})};o.get=()=>{let e={};for(let t in i)i.hasOwnProperty(t)&&(e[t]=i[t]);return e};o.on=(e,t,r)=>{!t||!r||e.split(",").forEach(n=>{n=n.trim(),i[n]||(i[n]=[],window.addEventListener(n,x,!0)),i[n].push({selector:t,callback:r})})};o.once=(e,t,r)=>{o.on(e,t,function n(s){r(s),o.off(e,t,n)})};o.off=(e,t,r)=>{e.split(",").forEach(n=>{if(n=n.trim(),!i[n])return;if(i[n].length<2||!t){delete i[n],window.removeEventListener(n,x,!0);return}let s=_(i[n],t,r);s<0||i[n].splice(s,1)})};var O=o;var S=class extends f{constructor(t){t.isSharedState=!0,super(null,t)}},T=S;return H;})();
//# sourceMappingURL=kff.min.js.map
